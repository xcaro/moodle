YUI.add("moodle-atto_indent-button",function(d,e){d.namespace("M.atto_indent").Button=d.Base.create("button",d.M.editor_atto.EditorPlugin,[],{initializer:function(){this.addButton({icon:"e/decrease_indent",title:"outdent",buttonName:"outdent",callback:this.outdent}),this.addButton({icon:"e/increase_indent",title:"indent",buttonName:"indent",callback:this.indent})},indent:function(){var e=window.rangy.saveSelection(),t=this.editor.all("blockquote"),n=t.size();this.editor.all(".rangySelectionBoundary").setStyle("display",null),t.addClass("pre-existing"),document.execCommand("indent",!1,null),this.indentListItem(),(t=this.editor.all("blockquote")).size()!==n?(this.replaceBlockquote(this.editor),window.rangy.restoreSelection(e)):0<t.size()&&t.removeClass("pre-existing"),window.rangy.removeMarkers(e),this.markUpdated()},outdent:function(){var e=window.rangy.saveSelection(),t=this.editor.all("blockquote"),n=t.size();t.addClass("pre-existing"),this.replaceEditorIndents(this.editor),window.rangy.restoreSelection(e),e=window.rangy.saveSelection(),document.execCommand("outdent",!1,null),(t=this.editor.all("blockquote")).size()!==n?(this.replaceBlockquote(this.editor),window.rangy.restoreSelection(e)):0<t.size()&&t.removeClass("pre-existing"),window.rangy.removeMarkers(e),this.markUpdated()},replaceBlockquote:function(e){var t,n,o,i,r;for(e.all("blockquote").setAttribute("data-iterate",!0),t=e.one("blockquote"),n=d.one("body.dir-ltr")?"marginLeft":"marginRight";t;){if(t.removeAttribute("data-iterate"),t.hasClass("pre-existing"))t.removeClass("pre-existing");else{for(o=d.Node.create("<div></div>").setAttrs(t.getAttrs()).setStyle(n,"30px").addClass("editor-indent"),r=(i=t.getDOMNode().childNodes)[0];void 0!==r;)o.append(r),r=i[0];t.replace(o)}t=e.one("blockquote[data-iterate]")}},replaceEditorIndents:function(e){for(var t,n,o,i=e.one(".editor-indent");i;){for(t=d.Node.create("<blockquote></blockquote>").setAttrs(i.getAttrs()).removeClass("editor-indent"),o=(n=i.getDOMNode().childNodes)[0];void 0!==o;)t.append(o),o=n[0];i.replace(t),i=e.one(".editor-indent")}},indentListItem:function(){var e,t=window.rangy.getSelection().anchorNode,n=this.getRootElement(),o=this.getParent(t,"ul, ol",n);o&&(e=o.previousElementSibling)&&"LI"===e.tagName&&e.appendChild(o)},getParents:function(e,t,n,o){var i,r=[];for(n=n||this.getRootElement()||document.body,i=e;i&&i!==n&&i.nodeType&&9!==i.nodeType;){if(-1<t.toUpperCase().indexOf(i.tagName)){if(!o)return[i];r.push(i)}i=i.parentNode}return r},getParent:function(e,t,n){var o=this.getParents(e,t,n,!1);return o&&0<o.length?o[0]:null},getRootElement:function(){return this.editor.getDOMNode()}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});